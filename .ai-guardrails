# AI GUARDRAILS â€” BRAINLIEST PROJECT
# This file MUST be read by any AI assistant before performing ANY task
# Violation of these rules is a CRITICAL FAILURE

## ðŸ§  PERMANENT MEMORY ACTIVATION
Every AI session MUST start with this protocol:
1. "I have loaded PROJECT_MANIFEST.md into memory"
2. "I have reviewed the deep audit checklist"
3. "I understand zero-drift and zero-duplication requirements"
4. "I will ask when unclear rather than assume"
5. "Ready to proceed with [task name]"

## MANDATORY READING ORDER
1. .ai-guardrails (THIS FILE - 2 min)
2. PROJECT_MANIFEST.md (REQUIRED - 15 min)
3. COMPLETE_BUILD_SPECIFICATION.md (implementation details)
4. ARCHITECTURE_BLUEPRINT.md (architecture patterns)
5. UI_COMPONENT_SPECIFICATION.md (when creating UI components)

## FORBIDDEN ACTIONS
âŒ Create new architectural documents
âŒ Create duplicate schemas/types/interfaces
âŒ Create duplicate UI components (check existing first)
âŒ Modify locked documents without approval
âŒ Use 'any' type in TypeScript
âŒ Access process.env directly (use typed env)
âŒ Import DB in UI packages
âŒ Import apps/web in apps/admin or vice versa
âŒ Create README.md in individual packages
âŒ Hardcode domains (use SITE_PRIMARY_DOMAIN env)
âŒ Hardcode colors/spacing (use design tokens)
âŒ Skip Zod validation at boundaries
âŒ Create files not listed in specifications
âŒ Skip deep audit before implementation
âŒ Skip component existence check before creating
âŒ Assume or guess when unclear

## REQUIRED ACTIONS
âœ… Read PROJECT_MANIFEST.md before starting
âœ… Read UI_COMPONENT_SPECIFICATION.md before creating components
âœ… Run DEEP AUDIT CHECKLIST before coding
âœ… Search existing components before creating new ones
âœ… Verify file path matches monorepo structure
âœ… Check SSOT location before creating types
âœ… Use design tokens (never hardcode colors/spacing)
âœ… Search for duplicate code/logic
âœ… Scan for circular dependencies
âœ… Run dependency cruiser to validate imports
âœ… Follow naming conventions exactly
âœ… Create tests for all new code (>80% coverage)
âœ… Create Storybook stories for UI components
âœ… Verify accessibility (ARIA, keyboard nav)
âœ… Test responsive behavior (mobile-first)
âœ… Ask user when specifications are unclear
âœ… Escalate when encountering conflicts
âœ… Update package index exports for new modules
âœ… Maintain zero drift from specifications
âœ… Check for race conditions in async code
âœ… Verify no hardcoded URLs

## DEEP AUDIT REQUIREMENTS
Before ANY implementation:
â–¡ Logic issues reviewed
â–¡ Code duplication checked (jscpd)
â–¡ Code smells identified
â–¡ SSOT violations verified (0 found)
â–¡ Circular dependencies scanned (madge)
â–¡ Unwanted coupling checked
â–¡ Race conditions reviewed
â–¡ Type safety verified (0 'any' usage)
â–¡ Schema issues checked
â–¡ URL hardcoding scanned
â–¡ Import/export hygiene verified
â–¡ Performance issues identified (N+1, missing indexes)
â–¡ Security audit passed (secrets, injection)

## EMERGENCY STOP CONDITIONS
ðŸ›‘ Specification conflict detected
ðŸ›‘ Security vulnerability identified
ðŸ›‘ Forbidden import dependency detected
ðŸ›‘ Duplicate type/schema/constant found
ðŸ›‘ Unable to determine SSOT location
ðŸ›‘ User approval required but not obtained
ðŸ›‘ Circular dependency detected
ðŸ›‘ 'any' type usage found
ðŸ›‘ Race condition identified
ðŸ›‘ SSOT violation found
ðŸ›‘ Code duplication detected (>5 lines)

## QUALITY GATES (ALL MUST PASS)
â–¡ pnpm typecheck (0 errors)
â–¡ pnpm lint (0 warnings)
â–¡ pnpm test (100% pass)
â–¡ pnpm depgraph (0 violations)
â–¡ pnpm madge --circular (0 cycles)
â–¡ rg "\bany\b" --type ts (0 matches)
â–¡ pnpm jscpd (0 duplicates >5 lines)
â–¡ pnpm build (success)

## AUTOMATED AUDIT COMMANDS
Run these BEFORE considering task complete:

# TypeScript errors
pnpm typecheck 2>&1 | grep -c "error TS"  # Must = 0

# Search for 'any' usage
rg "\bany\b" --type ts --glob '!node_modules' --glob '!*.test.ts' | wc -l  # Must = 0

# Circular dependencies
pnpm madge --circular --extensions ts,tsx ./apps ./packages  # Must be empty

# Forbidden patterns
rg "process\.env\." --type ts --glob '!packages/config/**'  # Must be empty
rg "admin.brainliest.com|brainliest.com" --type ts --glob '!packages/config/**'  # Must be empty

# Duplicate code
pnpm jscpd --min-lines 5 --min-tokens 50 ./apps ./packages  # Must = 0%

# Dependency validation
pnpm depcruise --validate .dependency-cruiser.js src  # Must pass

## ESCALATION PROTOCOL
When in doubt: STOP â†’ ASK USER â†’ WAIT FOR APPROVAL
Never guess. Never assume. Always ask.

## DOCUMENT AUTHORITY HIERARCHY
1. PROJECT_MANIFEST.md (highest authority)
2. COMPLETE_BUILD_SPECIFICATION.md (implementation contract)
3. ARCHITECTURE_BLUEPRINT.md (patterns & rationale)
4. Existing code implementation
5. ADRs (historical context only)

## SESSION END PROTOCOL
Before marking task complete:
1. Run ALL automated audit commands above
2. Review deep audit checklist in PROJECT_MANIFEST.md
3. Confirm all quality gates pass
4. Request user review and approval
5. Update CHANGELOG.md if specifications changed

## ZERO TOLERANCE VIOLATIONS
These will result in IMMEDIATE TASK FAILURE:
- Using 'any' type
- SSOT violation (duplicate schema/type)
- Circular dependency introduced
- Forbidden import (appsâ†’db, uiâ†’infra)
- Hardcoded secret or domain
- Skipping deep audit
- Modifying locked documents without approval

---
Last Updated: 2025-10-02
Version: 2.0.0 LOCKED
Enforced by: ALL AI assistants working on this project
